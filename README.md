# 自動モザエセ v1.0 - AI自動モザイク処理ツール

[![License](https://img.shields.io/badge/License-AGPL%203.0-blue.svg)](LICENSE)
[![Python](https://img.shields.io/badge/Python-3.11%2B-blue)](https://www.python.org/)
[![Platform](https://img.shields.io/badge/Platform-Windows-blue)](https://www.microsoft.com/windows)
[![AI](https://img.shields.io/badge/AI-YOLOv8%20%2B%20SAM%20%2B%20NudeNet-green)](https://github.com/ultralytics/ultralytics)

## 📋 概要

自動モザエセは、AI技術を活用してアニメ・イラスト画像の男女局部を自動検出し、適切なモザイク処理を適用するツールです。YOLOv8 + SAM + NudeNet の組み合わせにより、高精度な検出と自然な仕上がりを実現します。

### ✨ 主要機能

- **🧠 マルチAI検出**: YOLOv8、NudeNet、ハイブリッド検出
- **🎭 高品質モザイク**: ブロック・ガウス・白塗り・黒塗り対応
- **⚡ バッチ処理**: 複数画像の一括処理
- **🔐 統合認証**: Discord認証 + 月次パスワード認証
- **🔧 開発者モード**: 配布版と開発版の動的切り替え
- **📱 直感的UI**: 初心者からプロまで使いやすいインターフェース

### 🎯 対象ユーザー

- **一般ユーザー**: 簡単操作でのモザイク処理
- **開発者**: 詳細設定とデバッグ機能
- **配布者**: FANZA基準対応の安全な処理

---

## 📚 ドキュメント

### 📖 ユーザー向けドキュメント

| ドキュメント | 説明 | 対象 |
|-------------|------|------|
| **[📱 ユーザーガイド](docs/USER_GUIDE.md)** | 詳細な使い方ガイド | エンドユーザー |

### 🏗️ 開発者向けドキュメント

| ドキュメント | 説明 | 対象 |
|-------------|------|------|
| **[🏗️ ビルドマニュアル](docs/BUILD_MANUAL.md)** | 完全なビルド・配布ガイド | 開発者・メンテナー |
| **[📋 コード構成・アーキテクチャ](docs/CODE_ARCHITECTURE.md)** | アーキテクチャ・設計・実装詳細 | 開発者 |
| **[🔧 開発者ガイド](docs/DEVELOPER_GUIDE.md)** | 開発環境構築・コーディング規約 | 開発者 |

---

## 🚀 クイックスタート

### 🎯 エンドユーザー向け

```bash
# 1. 配布されたZIPファイルを展開
# 2. 自動モザエセ.exe をダブルクリック
# 3. 初回セットアップダイアログで「スマートセットアップ」を実行
# 4. Discord認証完了後、利用開始
```

**📖 詳細手順**: [ユーザーガイド](docs/USER_GUIDE.md) をご参照ください。

### 🔧 開発者向け

```bash
# 1. 開発環境セットアップ
python -m venv .venv
.venv\Scripts\activate.bat
pip install -r requirements.txt

# 2. CUDA/CPU環境最適化（ビルド前に必須）
cd builds
python setup_onnx_runtime.py

# 3. 開発者モードで起動
python -m auto_mosaic

# 4. PyInstallerでビルド
cd builds
pyinstaller build_distribution.spec --clean --noconfirm
pyinstaller build_developer.spec --clean --noconfirm
```

**🏗️ 詳細手順**: [ビルドマニュアル](docs/BUILD_MANUAL.md) をご参照ください。

---

## 💻 システム要件

### 最小要件

| 項目 | 要件 |
|------|------|
| **OS** | Windows 10 (64bit) |
| **メモリ** | 8GB RAM |
| **ストレージ** | 5GB以上の空き容量 |
| **ネットワーク** | インターネット接続（初回のみ） |

### 推奨要件

| 項目 | 推奨 |
|------|------|
| **OS** | Windows 11 最新版 |
| **メモリ** | 16GB以上 |
| **GPU** | NVIDIA RTX 4060以上 |
| **ストレージ** | 10GB以上（SSD推奨） |
| **ネットワーク** | 高速ブロードバンド |

---

## 🏗️ アーキテクチャ概要

### システム構成

```
┌─────────────────────────────────────────┐
│           自動モザエセ v1.0              │
├─────────────────────────────────────────┤
│ 🖥️ プレゼンテーション層                 │
│  ├── 統合GUI (gui.py)                   │
│  └── 統合認証UI (auth_manager.py)       │
├─────────────────────────────────────────┤
│ 🔐 認証・セキュリティ層                  │
│  ├── 統合認証マネージャー                │
│  ├── Discord認証アダプター               │
│  ├── 月次パスワード認証                  │
│  └── 暗号化設定管理                     │
├─────────────────────────────────────────┤
│ 🧠 AI処理層                            │
│  ├── マルチモデル検出器                  │
│  ├── NudeNet検出器                      │
│  ├── SAMセグメンテーション               │
│  └── モザイク処理エンジン                │
├─────────────────────────────────────────┤
│ 📦 サポート・ユーティリティ層            │
│  ├── モデルダウンローダー                │
│  ├── 遅延読み込みシステム                │
│  └── 共通ユーティリティ                 │
└─────────────────────────────────────────┘
```

**📋 詳細**: [コード構成・アーキテクチャ](docs/CODE_ARCHITECTURE.md) をご参照ください。

---

## 🔐 認証システム

### 統合認証の特徴

- **🔄 動的切り替え**: Discord認証 ↔ 月次パスワード認証
- **🔧 開発者モード**: 詳細設定とデバッグ機能
- **🛡️ セキュリティ**: 暗号化された認証データ
- **🔀 フォールバック**: 認証失敗時の代替手段

### 認証フロー

```
一般ユーザー: Discord認証のみ → アプリケーション起動
開発者: 認証方式選択 → 認証実行 → 高度な機能利用
```

---

## 🧠 AI技術スタック

### 検出技術

| 技術 | 用途 | 精度 |
|------|------|------|
| **YOLOv8** | アニメ・イラスト検出 | 95-99% |
| **NudeNet** | 実写画像検出 | 85-95% |
| **ハイブリッド** | 自動判別・統合処理 | 最高 |

### セグメンテーション

| 技術 | 特徴 | 品質 |
|------|------|------|
| **SAM ViT-B** | 高精度輪郭検出 | 極高 |
| **バウンディングボックス** | 高速矩形処理 | 標準 |

### モザイク処理

| 効果 | 特徴 | 用途 |
|------|------|------|
| **ブロックモザイク** | FANZA準拠タイル | 一般配布 |
| **ガウスモザイク** | 自然なぼかし | 高品質仕上げ |
| **白塗り・黒塗り** | 完全隠蔽 | 強制隠蔽 |

---

## 📦 ビルド・配布

### ビルドシステム

```bash
# 推奨PyInstallerベースビルド
cd builds
pyinstaller build_distribution.spec --clean --noconfirm
pyinstaller build_developer.spec --clean --noconfirm

# ワンライナー実行
cd builds && pyinstaller build_distribution.spec --clean --noconfirm && pyinstaller build_developer.spec --clean --noconfirm
```

### 配布パッケージ

```
builds/
└── dist/
    ├── 自動モザエセ_配布版/     # 一般配布用（静音起動）
    └── 自動モザエセ_開発版/     # 開発者用（詳細出力）
```

**🔧 詳細**: [ビルドマニュアル](docs/BUILD_MANUAL.md) をご参照ください。

---

## 🧪 テスト・品質保証

### テストカバレッジ

- **統合認証テスト**: 認証システム全体の動作確認
- **AI検出テスト**: 各検出モデルの精度検証
- **モザイク処理テスト**: 各効果の品質確認
- **EXE版テスト**: 配布環境での動作検証

### 品質管理

```bash
# ビルドテスト実行
python test_build_integrity.py

# 認証システムテスト
python -c "from auto_mosaic.src.auth_manager import AuthenticationManager; print('OK')"

# モジュール整合性確認
python -c "import auto_mosaic; print('OK')"
```

**🧪 詳細**: テストコードは開発環境で実行可能です。

---

## 🔧 開発環境セットアップ

### 1. 基本環境

```bash
# Python 3.11以上が必要
python --version

# 仮想環境作成
python -m venv .venv
.venv\Scripts\activate.bat

# 依存関係インストール
pip install --upgrade pip
pip install -r requirements.txt
```

### 2. 開発者モード設定

```bash
# 開発者モード設定ユーティリティ
python setup_developer_mode.py

# 暗号化設定作成
python setup_encrypted_config.py
```

### 3. 開発起動

```bash
# 直接実行
python -m auto_mosaic
```

---

## 📊 パフォーマンス

### 処理速度（RTX 4060環境）

| 処理内容 | 1920x1080画像 | 備考 |
|----------|---------------|------|
| **AI検出** | 0.1-0.5秒 | モデルにより変動 |
| **セグメンテーション** | 0.2-0.4秒 | SAM ViT-B使用時 |
| **モザイク適用** | 0.05-0.1秒 | 効果により変動 |
| **総処理時間** | 0.35-1.0秒 | 設定最適化時 |

### メモリ使用量

| 処理モード | 使用量 | 備考 |
|------------|--------|------|
| **軽量モード** | 2-4GB | CPU処理 |
| **標準モード** | 4-8GB | GPU処理 |
| **高品質モード** | 8-16GB | 大量バッチ処理 |

---

## 🤝 貢献・開発参加

### 開発に参加するには

1. **フォーク**: プロジェクトをフォーク
2. **ブランチ**: 機能ブランチを作成
3. **開発**: 機能実装・テスト
4. **プルリクエスト**: 変更内容を提出

### コーディング規約

- **命名**: snake_case（関数・変数）、PascalCase（クラス）
- **ドキュメント**: 日本語コメント + 英語docstring
- **テスト**: 新機能は必ずテストコード作成
- **ログ**: 適切なログレベルでの出力

**📋 詳細**: [コード構成ドキュメント](docs/CODE_ARCHITECTURE.md) の規約セクションをご参照ください。

---

## 📄 ライセンス・著作権

### ライセンス

- **メインプロジェクト**: AGPL-3.0
- **YOLOv8**: AGPL-3.0 (Ultralytics)
- **SAM**: Apache-2.0 (Meta AI)
- **NudeNet**: MIT

### 使用上の注意

```
✅ 個人利用・商用利用可能
✅ 改変・再配布可能（AGPL-3.0準拠）
❌ 改変時はソースコード公開が必要
❌ 違法コンテンツの処理は禁止
⚖️ 法的コンプライアンスは利用者責任
```

### 免責事項

本ソフトウェアは「現状のまま」提供されており、使用による一切の損害について製作者は責任を負いません。

---

## 📞 サポート・コミュニティ

### 🆘 サポート

- **バグレポート**: [GitHub Issues](../../issues)
- **機能要望**: [GitHub Issues](../../issues)
- **使い方質問**: [GitHub Discussions](../../discussions)

### 📝 ドキュメント改善

- 誤字・脱字の修正
- 操作手順の改善提案
- 新機能の解説追加

### 🌐 コミュニティ参加

- **開発者**: 機能開発・バグ修正への貢献
- **テスター**: 品質確保・動作検証への協力
- **ドキュメンター**: 文書作成・改善への協力

プルリクエストやIssueでの貢献をお待ちしています！

---

## 🔮 ロードマップ

### 短期計画（v1.1）
- **新AI検出モデル**: YOLOv9、YOLOv10対応
- **UI/UX改善**: ダークモード、テーマ切り替え
- **パフォーマンス向上**: メモリ使用量削減

### 中期計画（v2.0）
- **マルチプラットフォーム**: macOS、Linux対応
- **クラウド連携**: モデル自動更新、設定同期
- **API化**: REST API、CLI インターフェース

### 長期計画（v3.0）
- **リアルタイム処理**: 動画ストリーム対応
- **プラグインシステム**: サードパーティ拡張
- **機械学習強化**: カスタムモデル訓練

---

## 📈 統計・実績

### 開発実績
- **コード行数**: 10,000行以上
- **主要言語**: Python
- **ドキュメント**: 完全日本語対応
- **ライセンス**: AGPL-3.0

---

**🎉 自動モザエセを選んでいただき、ありがとうございます！**

**📝 このREADMEは自動モザエセ v1.0 の包括的な情報を提供しています。**
**🔄 最終更新: 2025年8月**
**💬 ご質問・ご要望がございましたら、お気軽にお問い合わせください。** 